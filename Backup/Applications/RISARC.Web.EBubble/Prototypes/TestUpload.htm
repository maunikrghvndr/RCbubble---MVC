<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>

    <script type="text/javascript">
        function init() {
            document.getElementById('file_upload_form').onsubmit = function() {
                document.getElementById('testLabeL').innerHTML = "populated";
                //alert('submitting');
                //document.getElementById('file_upload_form').target = 'upload_target'; //'upload_target' is the name of the iframe
                document.getElementById("upload_target").onload = uploadDone; //This function should be called when the iframe has compleated loading
                // That will happen when the file is completely uploaded and the server has returned the data we need.
                //return false;
            }
        }

        function uploadDone() { //Function will be called when iframe is loaded
            alert('uploadDone');
            var ret = frames['upload_target'].document.getElementsByTagName("body")[0].innerHTML;
            var data = eval("(" + ret + ")"); //Parse JSON // Read the below explanations before passing judgment on me

            if (data.success) { //This part happens when the image gets uploaded.
                document.getElementById("image_details").innerHTML = "<img src='image_uploads/" + data.file_name + "' /><br />Size: " + data.size + " KB";
            }
            else if (data.failure) { //Upload failed - show user the reason.
                alert("Upload Failed: " + data.failure);
            }
        }
        window.onload = init;
    
    </script>

</head>
<body>

    <label id="testLabeL">notPopulated</label>
    <form id="file_upload_form" method="post" enctype="multipart/form-data" target="upload_target"
    action="/DocumentAdmin/UploadDocumentFile">
    <input name="FileUpload" id="file" size="27" type="file" /><br />
    <input type="submit" name="action" value="Upload" /><br />
    <iframe id="upload_target" name="upload_target" src="" style="width: 0; height: 0;
        border: 0px solid #fff;">

    </iframe>
    </form>
    <div id="image_details">
    </div>
</body>
</html>
